<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>逸站 ~ EliEliAri干杯</title>
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 Lucide 图标库 -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        :root {
            --primary-blue: #4c84b2;
            --primary-blue-dark: #125b8f;
        }

        body {
            font-family: 'Noto Sans SC', system-ui, -apple-system, sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
        }
        
        .header-style {
            position: fixed; 
            top: 0;
            left: 0;
            right: 0;
            width: 100%;
            height: 4rem; 
            background-color: rgba(255, 255, 255, 0.95); 
            border-bottom-left-radius: 1em;
            border-bottom-right-radius: 1em;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            z-index: 40; /* 稍微降低，保证悬浮按钮在最上层 */
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
        }

        .card-style {
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }
        .card-style:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-blue);
        }
        
        main {
            padding-top: 6rem; 
            padding-bottom: 2rem;
        }

        .theme-text-color {
            color: var(--primary-blue-dark);
        }
        .theme-bg-color {
            background-color: color-mix(in srgb, var(--primary-blue) 10%, white);
        }
        .theme-border-color {
            border-color: color-mix(in srgb, var(--primary-blue) 20%, white);
        }

        /* 悬浮按钮相关样式 */
        .fab-container {
            z-index: 50;
        }
        .fab-button {
            background-color: var(--primary-blue);
            box-shadow: 0 4px 12px rgba(76, 132, 178, 0.4);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        .fab-button:hover {
            background-color: var(--primary-blue-dark);
            transform: scale(1.05);
        }
        .fab-menu {
            transform-origin: bottom right;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        /* 隐藏状态 */
        .fab-menu.closed {
            opacity: 0;
            transform: scale(0.8) translateY(20px);
            pointer-events: none;
        }
        /* 显示状态 */
        .fab-menu.open {
            opacity: 1;
            transform: scale(1) translateY(0);
            pointer-events: auto;
        }
    </style>
</head>
<body class="min-h-screen relative">

    <!-- 顶部导航栏 -->
    <header class="header-style">
        <div class="max-w-7xl mx-auto px-6 sm:px-8 lg:px-10 h-full flex items-center justify-between w-full">
            <h1 class="text-2xl font-extrabold text-gray-900 tracking-tight flex items-center gap-3">
                <i data-lucide="monitor-dot" class="w-7 h-7 theme-text-color"></i>
                <span>逸站 ~ EliEliAri</span>
            </h1>
            <p class="text-sm text-gray-500 hidden sm:block">共有 <span id="video-count" class="font-bold theme-text-color">0</span> 个视频</p>
        </div>
    </header>

    <!-- 主要内容区 -->
    <main class="max-w-7xl mx-auto px-6 sm:px-8 lg:px-10">
        <section id="video-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <!-- 视频卡片将由 JS 渲染在此处 -->
            <div id="loading-message" class="col-span-full text-center py-10 text-gray-500">
                <i data-lucide="loader-circle" class="w-8 h-8 mx-auto animate-spin mb-3"></i>
                <p>正在载入视频列表...</p>
            </div>
        </section>
        
        <!-- 无搜索结果提示 (默认隐藏) -->
        <div id="no-results" class="hidden text-center py-20 text-gray-400">
            <i data-lucide="search-x" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
            <p>没有找到匹配的视频</p>
        </div>
    </main>

    <footer class="border-t border-gray-200 mt-12 py-6 text-center text-gray-500 text-sm bg-white shadow-inner">
        <p>&copy; 2025 逸站 EVPlayer Template. 视频列表由 video_list.js 提供。</p>
    </footer>

    <!-- 右下角悬浮菜单 (FAB) -->
    <div class="fab-container fixed bottom-20 right-10 flex flex-col items-end gap-4">
        
        <!-- 展开的菜单内容 -->
        <div id="fab-menu-content" class="fab-menu closed w-64 bg-white/95 backdrop-blur-md p-4 rounded-2xl shadow-xl border border-gray-100">
            
            <!-- 1. 搜索功能 -->
            <div class="mb-4">
                <label class="text-xs font-semibold text-gray-500 mb-1 block uppercase tracking-wider">快速搜索</label>
                <div class="relative">
                    <i data-lucide="search" class="absolute left-3 top-2.5 w-4 h-4 text-gray-400"></i>
                    <input type="text" id="search-input" placeholder="搜索标题或作者..." 
                           class="w-full pl-9 pr-4 py-2 text-sm bg-gray-100 border-transparent focus:bg-white border focus:border-blue-300 rounded-lg outline-none transition-all">
                </div>
            </div>
            
            <hr class="border-gray-100 mb-3">

            <!-- 2. 导航链接 -->
            <div class="flex flex-col gap-2">
                <a href="/index.html" class="flex items-center gap-3 p-2 hover:bg-gray-50 rounded-lg text-gray-700 transition-colors group">
                    <div class="p-2 bg-blue-50 rounded-full text-blue-600 group-hover:bg-blue-100 transition-colors">
                        <i data-lucide="home" class="w-4 h-4"></i>
                    </div>
                    <span class="font-medium text-sm">返回首页</span>
                </a>
                
                <!-- 链接内容请自行补充 -->
                <a href="/subpages/index3.html" class="flex items-center gap-3 p-2 hover:bg-gray-50 rounded-lg text-gray-700 transition-colors group">
                    <div class="p-2 bg-amber-50 rounded-full text-amber-600 group-hover:bg-amber-100 transition-colors">
                        <i data-lucide="history" class="w-4 h-4"></i>
                    </div>
                    <span class="font-medium text-sm">返回旧版</span>
                </a>
            </div>
        </div>

        <!-- 主按钮 -->
        <button id="fab-trigger" title="菜单" class="fab-button w-14 h-14 rounded-full flex items-center justify-center text-white shadow-lg cursor-pointer outline-none">
    <!-- 图标 1：三条线 (默认显示) -->
    <i id="icon-menu" data-lucide="menu" class="w-7 h-7 transition-transform duration-300"></i>
    
    <!-- 图标 2：叉号 (默认隐藏) -->
    <i id="icon-close" data-lucide="x" class="w-7 h-7 absolute opacity-0 rotate-90 transition-all duration-300"></i>
</button>

<a href="/index.html">
         <button id="fab-main-button" title="返回首页" class="fab-button w-14 h-14 rounded-full flex items-center justify-center text-white shadow-lg cursor-pointer outline-none">
         <i data-lucide="home" class="w-7 h-7"></i>
         </button></a>
    </div>

    <!-- 引入视频列表数据 -->
    <script src="./video_list.js"></script>

    <!-- 页面逻辑 -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
            
            // 初始渲染完整列表
            // 检查 videoList 是否存在，防止报错
            if (typeof videoList !== 'undefined') {
                renderVideoList(videoList);
            } else {
                renderVideoList([]);
            }

            initFab();
        });

        // 渲染函数：支持接收特定的数据数组（用于搜索过滤）
        function renderVideoList(data) {
            const grid = document.getElementById('video-grid');
            const videoCountSpan = document.getElementById('video-count');
            const noResults = document.getElementById('no-results');
            
            grid.innerHTML = ''; // 清空现有内容

            // 错误处理或空数据处理
            if (!data || data.length === 0) {
                // 如果是全局列表为空，显示错误；如果是搜索结果为空，显示无结果
                if (typeof videoList !== 'undefined' && videoList.length > 0) {
                    // 这是搜索结果为空的情况
                    noResults.classList.remove('hidden');
                    videoCountSpan.textContent = '0';
                } else {
                    // 这是原始数据就为空的情况
                    grid.innerHTML = '<div class="col-span-full text-center py-10 text-gray-500">未找到任何视频数据。请检查 video_list.js 文件。</div>';
                    videoCountSpan.textContent = '0';
                }
                return;
            }

            // 有数据时，隐藏无结果提示
            noResults.classList.add('hidden');
            videoCountSpan.textContent = data.length;

            data.forEach(video => {
                const card = document.createElement('a');
                card.href = `player.html?file=${video.data_file}`; 
                
                card.className = 'block bg-white rounded-xl p-5 border border-gray-200 card-style';
                card.innerHTML = `
                    <div class="flex items-start justify-between mb-4">
                        <span class="theme-bg-color theme-text-color text-xs font-semibold px-3 py-1 rounded-full border theme-border-color">${video.id}</span>
                        <i data-lucide="play-circle" class="w-6 h-6 text-gray-400"></i>
                    </div>
                    <h3 class="text-lg font-bold text-gray-900 mb-2 line-clamp-2" title="${video.title}">${video.title}</h3>
                    <div class="text-sm text-gray-600 mb-4">
                        <p class="truncate">作者: ${video.author}</p>
                        <p>发布: ${video.date}</p>
                    </div>
                    <button class="w-full text-center theme-text-color border theme-border-color py-2 rounded-full text-sm font-medium hover:bg-gray-50 transition-colors">
                        立即观看
                    </button>
                `;
                grid.appendChild(card);
            });
            
            lucide.createIcons(); // 渲染新插入的 DOM 中的图标
        }

        // 悬浮按钮与搜索逻辑
        function initFab() {
            const triggerBtn = document.getElementById('fab-trigger');
            const menuContent = document.getElementById('fab-menu-content');
            const searchInput = document.getElementById('search-input');
            let isOpen = false;

            // 切换菜单开关
            triggerBtn.addEventListener('click', (e) => {
                e.stopPropagation(); // 防止冒泡
                isOpen = !isOpen;
                toggleMenu();
            });

            function toggleMenu() {
    const iconMenu = document.getElementById('icon-menu');
    const iconClose = document.getElementById('icon-close');

    if (isOpen) {
        // 菜单打开状态
        menuContent.classList.remove('closed');
        menuContent.classList.add('open');
        triggerBtn.classList.add('active');
        
        // 图标动画：隐藏菜单，显示叉号
        iconMenu.classList.add('opacity-0', '-rotate-90');
        iconClose.classList.remove('opacity-0', 'rotate-90');
        
        setTimeout(() => searchInput.focus(), 100);
    } else {
        // 菜单关闭状态
        menuContent.classList.remove('open');
        menuContent.classList.add('closed');
        triggerBtn.classList.remove('active');
        
        // 图标动画：显示菜单，隐藏叉号
        iconMenu.classList.remove('opacity-0', '-rotate-90');
        iconClose.classList.add('opacity-0', 'rotate-90');
        
        searchInput.blur();
    }
}

            // 点击页面其他地方关闭菜单
            document.addEventListener('click', (e) => {
                if (isOpen && !menuContent.contains(e.target) && !triggerBtn.contains(e.target)) {
                    isOpen = false;
                    toggleMenu();
                }
            });

            // 搜索功能
            searchInput.addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase().trim();
                
                if (typeof videoList === 'undefined') return;

                if (!query) {
                    // 如果搜索框为空，显示全部
                    renderVideoList(videoList);
                } else {
                    // 过滤数据
                    const filtered = videoList.filter(video => 
                        video.title.toLowerCase().includes(query) || 
                        video.author.toLowerCase().includes(query) ||
                        video.id.toString().includes(query)
                    );
                    renderVideoList(filtered);
                }
            });
        }
    </script>
</body>
</html>